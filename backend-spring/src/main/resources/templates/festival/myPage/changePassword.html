<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{/layout/basic::setContent(~{this::content},~{this::title})}">
  <title th:fragment="title">추가정보 입력</title>
  <th:block th:fragment="content">

    <body>
    <h1>Change Password</h1>
    <form id="changePasswordForm">
      <div>
        <label for="oldPassword">Current Password:</label>
        <input type="password" id="oldPassword" name="oldPassword" required>
      </div>
      <div>
        <label for="newPassword">New Password:</label>
        <input type="password" id="newPassword" name="newPassword" required>
      </div>
      <button type="submit">Submit</button>
    </form>

    <script>
      $(document).ready(function() {
        $('#changePasswordForm').on('submit', function(event) {
          event.preventDefault(); // 기본 폼 제출 방지

          const oldPassword = $('#oldPassword').val();
          const newPassword = $('#newPassword').val();

          $.ajax({
            url: '/festival/myPage/changePassword',
            type: 'PUT',
            contentType: 'application/json',
            data: JSON.stringify({ oldPassword: oldPassword, newPassword: newPassword }),
            success: function(response) {
              alert('Password changed successfully.');
              window.location.href = response.redirectUrl; // 리다이렉트
            },
            error: function(xhr, status, error) {
              alert('Error: ' + xhr.responseText);
            }
          });
        });
      });
    </script>
    </body>

  </th:block>
</th:block>
