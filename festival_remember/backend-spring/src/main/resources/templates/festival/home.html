<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" >
<th:block th:replace="~{/layout/basic::setContent(~{this::content},~{this::title})}">
    <title th:fragment="title">home</title>
    <th:block th:fragment="content">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" th:href="@{/css/festival/home.css}">

    <body>
    <container>

        <hero>
            <div th:each="board : ${boardList}">
                <img th:src="${board.imageUrl}" th:alt="${board.title}"/>
            </div>
        </hero>

        <main>
            <div class="text-area" id="text-area">
                <div class="text-title">Fest inside</div>
                <div class="text-description">떠나고 싶은 너를 위한 퍼스널 가이드</div>
            </div>

<!--            <div class="controls">-->
<!--                <i class="fa-solid fa-chevron-left" id="prev"></i>-->
<!--                <i class="fa-solid fa-chevron-right" id="next"></i>-->
<!--            </div>-->
        </main>
    </container>

    <!-- Background image added here -->
    <img th:src="@{/images/festival/background.jpg}" alt="배경 이미지" id="backgroundImage" class="background-image">

    <search-navbar>
        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="검색어를 입력하세요" />
            <button onclick="searchFestival()">
                <i class="fa-brands fa-sistrix"></i>
            </button>
        </div>
        <div id="searchResults" class="search-results"></div>
    </search-navbar>

    <script>

        // 슬라이드쇼 동작
      document.addEventListener('DOMContentLoaded', function () {
          const images = document.querySelectorAll('hero img'); // 모든 이미지 선택
          let currentIndex = 0; // 현재 보여지는 이미지 인덱스

          // 첫 번째 이미지를 활성화
          if (images.length > 0) {
              images[0].classList.add('active');
          }

          // 5초 간격으로 이미지 변경
          setInterval(() => {
              // 현재 활성화된 이미지 숨김
              images[currentIndex].classList.remove('active');

              // 다음 이미지로 인덱스 변경 (마지막 이미지라면 처음으로 돌아감)
              currentIndex = (currentIndex + 1) % images.length;

              // 다음 이미지 활성화
              images[currentIndex].classList.add('active');
          }, 5000); // 5000ms = 5초
      });



        // const allFestivalList = []; // 서버에서 받아올 전체 축제 데이터 저장
        //
        // function searchFestival() {
        //     const keyword = document.getElementById('searchInput').value.replace(/\s+/g, '').toLowerCase(); // 공백 제거, 소문자 변환
        //     console.log(keyword)
        //     if (allFestivalList.length > 0) {
        //         // 클라이언트 측 필터링
        //         const filteredList = keyword === '' ? allFestivalList : allFestivalList.filter(festival =>
        //             festival.title.replace(/\s+/g, '').toLowerCase().includes(keyword) ||
        //             festival.content.replace(/\s+/g, '').toLowerCase().includes(keyword) ||
        //             festival.location.replace(/\s+/g, '').toLowerCase().includes(keyword)
        //         );
        //
        //         displayResults(filteredList);
        //     } else {
        //         // 서버에서 데이터 가져오기
        //         fetch(`/api/search?keyword=${keyword}`)
        //             .then(response => response.json())
        //             .then(data => {
        //                 allFestivalList.push(...data); // 서버 데이터를 로컬에 저장
        //                 displayResults(data);
        //             })
        //             .catch(error => {
        //                 console.error('검색 중 오류 발생:', error);
        //             });
        //     }
        // }
        //
        // // 검색 결과 표시
        // function displayResults(festivalList) {
        //     const resultsDiv = document.getElementById('searchResults');
        //     resultsDiv.innerHTML = ''; // 이전 검색 결과 초기화
        //
        //     if (festivalList.length === 0) {
        //         resultsDiv.innerHTML = '<p>검색 결과가 없습니다.</p>';
        //     } else {
        //         festivalList.forEach(festival => {
        //             const festivalDiv = document.createElement('div');
        //             festivalDiv.className = 'festival-item';
        //             festivalDiv.innerHTML = `
        //             <h3>${festival.title}</h3>
        //             <p>${festival.content}</p>
        //             <p><strong>위치:</strong> ${festival.location}</p>
        //         `;
        //             resultsDiv.appendChild(festivalDiv);
        //         });
        //     }
        // }

        // 모든 축제 데이터를 저장하는 배열 (선택적으로 사용)
        const allFestivalList = [];

        // 검색 함수
        function searchFestival() {
            const keyword = document.getElementById('searchInput').value.trim().toLowerCase(); // 공백 제거 및 소문자 변환

            if (keyword) {
                // 검색 키워드를 URL에 쿼리 파라미터로 추가하고 페이지 이동
                window.location.href = `/festival/map?keyword=${encodeURIComponent(keyword)}`;
            } else {
                // 검색 키워드를 URL에 쿼리 파라미터로 추가하고 페이지 이동
                window.location.href = `/festival/map?keyword=`;
            }
        }

        // 검색창에서 Enter 키로 검색 실행
        document.getElementById('searchInput').addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                searchFestival();
            }
        });



    </script>
    </body>
    </th:block>
</th:block>
</html>
